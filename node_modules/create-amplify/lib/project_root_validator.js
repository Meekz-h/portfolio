import { existsSync } from 'fs';
import * as path from 'path';
const amplifyLearnMoreUrl = 'https://docs.amplify.aws/gen2/how-amplify-works/';
/**
 *
 */
export class ProjectRootValidator {
    projectRoot;
    exists;
    /**
     * Validates that the given projectRoot path is a valid target for a new Amplify project
     */
    constructor(projectRoot, exists = existsSync) {
        this.projectRoot = projectRoot;
        this.exists = exists;
    }
    /**
     * Throws if a file or directory named 'amplify' already exists in the projectRoot
     * No-op if it doesn't exist
     */
    validate = async () => {
        const testPath = path.resolve(this.projectRoot, 'amplify');
        if (this.exists(testPath)) {
            throw new Error(`An amplify directory already exists at ${testPath}. If you are trying to run an Amplify (Gen 2) command inside an Amplify (Gen 1) project we recommend creating the project in another directory. Learn more about Amplify's new code-first DX (Gen 2): ${amplifyLearnMoreUrl}`);
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvamVjdF9yb290X3ZhbGlkYXRvci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9wcm9qZWN0X3Jvb3RfdmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxJQUFJLENBQUM7QUFDaEMsT0FBTyxLQUFLLElBQUksTUFBTSxNQUFNLENBQUM7QUFFN0IsTUFBTSxtQkFBbUIsR0FBRyxrREFBa0QsQ0FBQztBQUUvRTs7R0FFRztBQUNILE1BQU0sT0FBTyxvQkFBb0I7SUFLWjtJQUNBO0lBTG5COztPQUVHO0lBQ0gsWUFDbUIsV0FBbUIsRUFDbkIsU0FBUyxVQUFVO1FBRG5CLGdCQUFXLEdBQVgsV0FBVyxDQUFRO1FBQ25CLFdBQU0sR0FBTixNQUFNLENBQWE7SUFDbkMsQ0FBQztJQUVKOzs7T0FHRztJQUNILFFBQVEsR0FBRyxLQUFLLElBQW1CLEVBQUU7UUFDbkMsTUFBTSxRQUFRLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFFLFNBQVMsQ0FBQyxDQUFDO1FBQzNELElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsRUFBRTtZQUN6QixNQUFNLElBQUksS0FBSyxDQUNiLDBDQUEwQyxRQUFRLHlNQUF5TSxtQkFBbUIsRUFBRSxDQUNqUixDQUFDO1NBQ0g7SUFDSCxDQUFDLENBQUM7Q0FDSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGV4aXN0c1N5bmMgfSBmcm9tICdmcyc7XG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuXG5jb25zdCBhbXBsaWZ5TGVhcm5Nb3JlVXJsID0gJ2h0dHBzOi8vZG9jcy5hbXBsaWZ5LmF3cy9nZW4yL2hvdy1hbXBsaWZ5LXdvcmtzLyc7XG5cbi8qKlxuICpcbiAqL1xuZXhwb3J0IGNsYXNzIFByb2plY3RSb290VmFsaWRhdG9yIHtcbiAgLyoqXG4gICAqIFZhbGlkYXRlcyB0aGF0IHRoZSBnaXZlbiBwcm9qZWN0Um9vdCBwYXRoIGlzIGEgdmFsaWQgdGFyZ2V0IGZvciBhIG5ldyBBbXBsaWZ5IHByb2plY3RcbiAgICovXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgcHJvamVjdFJvb3Q6IHN0cmluZyxcbiAgICBwcml2YXRlIHJlYWRvbmx5IGV4aXN0cyA9IGV4aXN0c1N5bmNcbiAgKSB7fVxuXG4gIC8qKlxuICAgKiBUaHJvd3MgaWYgYSBmaWxlIG9yIGRpcmVjdG9yeSBuYW1lZCAnYW1wbGlmeScgYWxyZWFkeSBleGlzdHMgaW4gdGhlIHByb2plY3RSb290XG4gICAqIE5vLW9wIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgICovXG4gIHZhbGlkYXRlID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIGNvbnN0IHRlc3RQYXRoID0gcGF0aC5yZXNvbHZlKHRoaXMucHJvamVjdFJvb3QsICdhbXBsaWZ5Jyk7XG4gICAgaWYgKHRoaXMuZXhpc3RzKHRlc3RQYXRoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgQW4gYW1wbGlmeSBkaXJlY3RvcnkgYWxyZWFkeSBleGlzdHMgYXQgJHt0ZXN0UGF0aH0uIElmIHlvdSBhcmUgdHJ5aW5nIHRvIHJ1biBhbiBBbXBsaWZ5IChHZW4gMikgY29tbWFuZCBpbnNpZGUgYW4gQW1wbGlmeSAoR2VuIDEpIHByb2plY3Qgd2UgcmVjb21tZW5kIGNyZWF0aW5nIHRoZSBwcm9qZWN0IGluIGFub3RoZXIgZGlyZWN0b3J5LiBMZWFybiBtb3JlIGFib3V0IEFtcGxpZnkncyBuZXcgY29kZS1maXJzdCBEWCAoR2VuIDIpOiAke2FtcGxpZnlMZWFybk1vcmVVcmx9YFxuICAgICAgKTtcbiAgICB9XG4gIH07XG59XG4iXX0=